<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.innovative.dao.ApprouverDao">

	<resultMap id="informationApprouverMap"  type="com.innovative.bean.Approuver">
	  <id property="id" column="id" />
	  <result property="comentId" column="comentId"/>
	  <result property="approuverBy" column="approuverBy"/>
	  <result property="approuverAt" column="approuverAt"/>
	</resultMap> 

    <!--将图片保存到服务器，将记录保存到数据库-->
    <insert id="insertApprouver" parameterType="map">
       INSERT INTO "xacx_information_push_approuver" 
		("id", "comentId", "approuverBy", "approuverAt")
		 VALUES (#{id}, #{comentId},#{approuverBy},now());
    </insert>
    
      <!--根据id获取最近的一次点赞-->
	<!-- <select id="getApprouverLatest" resultType="informationApprouverMap">
		SELECT "approuverAt" FROM "xacx_information_push_approuver" 
		 WHERE "approuverBy" =  #{approuverBy} order by  "approuverAt" desc LIMIT 1
         offset 0 ;
	</select> -->
	
	<!-- 该用户今天是否对此信息已点赞 -->
	<select id="isTodayApprouverInfornaionPush" resultType="Integer">
		SELECT count(*) FROM "xacx_information_push_approuver" where "approuverBy" =  #{approuverBy} and "comentId" =  #{comentId} and to_date(cast("approuverAt" as TEXT),'yyyy-mm-dd') = current_date

	</select>


</mapper>